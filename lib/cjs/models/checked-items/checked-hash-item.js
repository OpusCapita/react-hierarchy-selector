"use strict";

exports.__esModule = true;
exports["default"] = void 0;

/* eslint-disable array-callback-return */
var parents = new WeakMap();
var checkedAll = new WeakMap();
var checkedItemsBackUp = new WeakMap();
var checkedItems = new WeakMap();

function addChildren(that, item) {
  if (item) {
    if (item.children && Array.isArray(item.children) && item.children.length > 0) {
      item.children.forEach(function (child) {
        addChildren(that, child);
      });
    } else {
      that.addCheckedItem(item);
    }
  }
}

var CheckedHashItem =
/*#__PURE__*/
function () {
  function CheckedHashItem(prnts) {
    if (prnts === void 0) {
      prnts = [];
    }

    this.timestamp = Date.now();
    parents.set(this, prnts.slice());
    checkedAll.set(this, false);
    checkedItems.set(this, []);
    checkedItemsBackUp.set(this, []);
  }

  var _proto = CheckedHashItem.prototype;

  _proto.getParents = function getParents() {
    return parents.get(this).slice();
  };

  _proto.getCheckedItems = function getCheckedItems() {
    return checkedItems.get(this).slice();
  };

  _proto.checkAll = function checkAll() {
    var prnts = parents.get(this);
    checkedAll.set(this, true);
    this.clearChecked();
    var initialParent = prnts.length > 0 ? prnts[prnts.length - 1] : undefined;
    if (initialParent) addChildren(this, initialParent);
  };

  _proto.uncheckAll = function uncheckAll() {
    checkedAll.set(this, false);
    this.clearChecked();
  };

  _proto.isCheckedAll = function isCheckedAll() {
    return checkedAll.get(this);
  };

  _proto.clearChecked = function clearChecked() {
    checkedItems.get(this).splice(0);
  };

  _proto.addCheckedItem = function addCheckedItem(item) {
    checkedItems.get(this).push(item);
  };

  _proto.removeCheckedItem = function removeCheckedItem(item) {
    var items = checkedItems.get(this);
    items.reduceRight(function (acc, currentItem, index, currentItems) {
      if (currentItem.id === item.id) {
        currentItems.splice(index, 1);
      }
    }, []);
  };

  _proto.createCopy = function createCopy() {
    var copy = new CheckedHashItem();
    parents.set(copy, [].concat(parents.get(this)));
    checkedAll.set(copy, checkedAll.get(this));
    checkedItems.set(copy, [].concat(checkedItems.get(this)));
    checkedItemsBackUp.set(copy, [].concat(checkedItemsBackUp.get(this)));
    return copy;
  };

  _proto.makeBackUp = function makeBackUp() {
    checkedItemsBackUp.set(this, [].concat(checkedItems.get(this)));
  };

  _proto.restoreFromBackUp = function restoreFromBackUp() {
    checkedItems.set(this, [].concat(checkedItemsBackUp.get(this)));
  };

  return CheckedHashItem;
}();

exports["default"] = CheckedHashItem;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3NyYy9tb2RlbHMvY2hlY2tlZC1pdGVtcy9jaGVja2VkLWhhc2gtaXRlbS5qcyJdLCJuYW1lcyI6WyJwYXJlbnRzIiwiV2Vha01hcCIsImNoZWNrZWRBbGwiLCJjaGVja2VkSXRlbXNCYWNrVXAiLCJjaGVja2VkSXRlbXMiLCJhZGRDaGlsZHJlbiIsInRoYXQiLCJpdGVtIiwiY2hpbGRyZW4iLCJBcnJheSIsImlzQXJyYXkiLCJsZW5ndGgiLCJmb3JFYWNoIiwiY2hpbGQiLCJhZGRDaGVja2VkSXRlbSIsIkNoZWNrZWRIYXNoSXRlbSIsInBybnRzIiwidGltZXN0YW1wIiwiRGF0ZSIsIm5vdyIsInNldCIsInNsaWNlIiwiZ2V0UGFyZW50cyIsImdldCIsImdldENoZWNrZWRJdGVtcyIsImNoZWNrQWxsIiwiY2xlYXJDaGVja2VkIiwiaW5pdGlhbFBhcmVudCIsInVuZGVmaW5lZCIsInVuY2hlY2tBbGwiLCJpc0NoZWNrZWRBbGwiLCJzcGxpY2UiLCJwdXNoIiwicmVtb3ZlQ2hlY2tlZEl0ZW0iLCJpdGVtcyIsInJlZHVjZVJpZ2h0IiwiYWNjIiwiY3VycmVudEl0ZW0iLCJpbmRleCIsImN1cnJlbnRJdGVtcyIsImlkIiwiY3JlYXRlQ29weSIsImNvcHkiLCJtYWtlQmFja1VwIiwicmVzdG9yZUZyb21CYWNrVXAiXSwibWFwcGluZ3MiOiI7Ozs7O0FBQUE7QUFFQSxJQUFNQSxPQUFPLEdBQUcsSUFBSUMsT0FBSixFQUFoQjtBQUNBLElBQU1DLFVBQVUsR0FBRyxJQUFJRCxPQUFKLEVBQW5CO0FBQ0EsSUFBTUUsa0JBQWtCLEdBQUcsSUFBSUYsT0FBSixFQUEzQjtBQUNBLElBQU1HLFlBQVksR0FBRyxJQUFJSCxPQUFKLEVBQXJCOztBQUVBLFNBQVNJLFdBQVQsQ0FBcUJDLElBQXJCLEVBQTJCQyxJQUEzQixFQUFpQztBQUMvQixNQUFJQSxJQUFKLEVBQVU7QUFDUixRQUFJQSxJQUFJLENBQUNDLFFBQUwsSUFBaUJDLEtBQUssQ0FBQ0Ms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QTNCO0FBQ0Q7QUFDRixLQUpELEVBSUcsRUFKSDtBQUtELEc7O1NBRURHLFUsR0FBQSxzQkFBYTtBQUNYLFFBQU1DLElBQUksR0FBRyxJQUFJM0IsZUFBSixFQUFiO0FBRUFmLElBQUFBLE9BQU8sQ0FBQ29CLEdBQVIsQ0FBWXNCLElBQVosWUFBc0IxQyxPQUFPLENBQUN1QixHQUFSLENBQVksSUFBWixDQUF0QjtBQUNBckIsSUFBQUEsVUFBVSxDQUFDa0IsR0FBWCxDQUFlc0IsSUFBZixFQUFxQnhDLFVBQVUsQ0FBQ3FCLEdBQVgsQ0FBZSxJQUFmLENBQXJCO0FBQ0FuQixJQUFBQSxZQUFZLENBQUNnQixHQUFiLENBQWlCc0IsSUFBakIsWUFBMkJ0QyxZQUFZLENBQUNtQixHQUFiLENBQWlCLElBQWpCLENBQTNCO0FBQ0FwQixJQUFBQSxrQkFBa0IsQ0FBQ2lCLEdBQW5CLENBQXVCc0IsSUFBdkIsWUFBaUN2QyxrQkFBa0IsQ0FBQ29CLEdBQW5CLENBQXVCLElBQXZCLENBQWpDO0FBRUEsV0FBT21CLElBQVA7QUFDRCxHOztTQUVEQyxVLEdBQUEsc0JBQWE7QUFDWHhDLElBQUFBLGtCQUFrQixDQUFDaUIsR0FBbkIsQ0FBdUIsSUFBdkIsWUFBaUNoQixZQUFZLENBQUNtQixHQUFiLENBQWlCLElBQWpCLENBQWpDO0FBQ0QsRzs7U0FFRHFCLGlCLEdBQUEsNkJBQW9CO0FBQ2xCeEMsSUFBQUEsWUFBWSxDQUFDZ0IsR0FBYixDQUFpQixJQUFqQixZQUEyQmpCLGtCQUFrQixDQUFDb0IsR0FBbkIsQ0FBdUIsSUFBdkIsQ0FBM0I7QUFDRCxHIiwic291cmNlc0NvbnRlbnQiOlsiLyogZXNsaW50LWRpc2FibGUgYXJyYXktY2FsbGJhY2stcmV0dXJuICovXG5cbmNvbnN0IHBhcmVudHMgPSBuZXcgV2Vha01hcCgpO1xuY29uc3QgY2hlY2tlZEFsbCA9IG5ldyBXZWFrTWFwKCk7XG5jb25zdCBjaGVja2VkSXRlbXNCYWNrVXAgPSBuZXcgV2Vha01hcCgpO1xuY29uc3QgY2hlY2tlZEl0ZW1zID0gbmV3IFdlYWtNYXAoKTtcblxuZnVuY3Rpb24gYWRkQ2hpbGRyZW4odGhhdCwgaXRlbSkge1xuICBpZiAoaXRlbSkge1xuICAgIGlmIChpdGVtLmNoaWxkcmVuICYmIEFycmF5LmlzQXJyYXkoaXRlbS5jaGlsZHJlbikgJiYgaXRlbS5jaGlsZHJlbi5sZW5ndGggPiAwKSB7XG4gICAgICBpdGVtLmNoaWxkcmVuLmZvckVhY2goKGNoaWxkKSA9PiB7IGFkZENoaWxkcmVuKHRoYXQsIGNoaWxkKTsgfSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoYXQuYWRkQ2hlY2tlZEl0ZW0oaXRlbSk7XG4gICAgfVxuICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIENoZWNrZWRIYXNoSXRlbSB7XG4gIGNvbnN0cnVjdG9yKHBybnRzID0gW10pIHtcbiAgICB0aGlzLnRpbWVzdGFtcCA9IERhdGUubm93KCk7XG4gICAgcGFyZW50cy5zZXQodGhpcywgcHJudHMuc2xpY2UoKSk7XG4gICAgY2hlY2tlZEFsbC5zZXQodGhpcywgZmFsc2UpO1xuICAgIGNoZWNrZWRJdGVtcy5zZXQodGhpcywgW10pO1xuICAgIGNoZWNrZWRJdGVtc0JhY2tVcC5zZXQodGhpcywgW10pO1xuICB9XG5cbiAgZ2V0UGFyZW50cygpIHtcbiAgICByZXR1cm4gcGFyZW50cy5nZXQodGhpcykuc2xpY2UoKTtcbiAgfVxuXG4gIGdldENoZWNrZWRJdGVtcygpIHtcbiAgICByZXR1cm4gY2hlY2tlZEl0ZW1zLmdldCh0aGlzKS5zbGljZSgpO1xuICB9XG5cbiAgY2hlY2tBbGwoKSB7XG4gICAgY29uc3QgcHJudHMgPSBwYXJlbnRzLmdldCh0aGlzKTtcbiAgICBjaGVja2VkQWxsLnNldCh0aGlzLCB0cnVlKTtcbiAgICB0aGlzLmNsZWFyQ2hlY2tlZCgpO1xuICAgIGNvbnN0IGluaXRpYWxQYXJlbnQgPSBwcm50cy5sZW5ndGggPiAwID8gcHJudHNbcHJudHMubGVuZ3RoIC0gMV0gOiB1bmRlZmluZWQ7XG5cbiAgICBpZiAoaW5pdGlhbFBhcmVudCkgYWRkQ2hpbGRyZW4odGhpcywgaW5pdGlhbFBhcmVudCk7XG4gIH1cblxuICB1bmNoZWNrQWxsKCkge1xuICAgIGNoZWNrZWRBbGwuc2V0KHRoaXMsIGZhbHNlKTtcbiAgICB0aGlzLmNsZWFyQ2hlY2tlZCgpO1xuICB9XG5cbiAgaXNDaGVja2VkQWxsKCkge1xuICAgIHJldHVybiBjaGVja2VkQWxsLmdldCh0aGlzKTtcbiAgfVxuXG4gIGNsZWFyQ2hlY2tlZCgpIHtcbiAgICBjaGVja2VkSXRlbXMuZ2V0KHRoaXMpLnNwbGljZSgwKTtcbiAgfVxuXG4gIGFkZENoZWNrZWRJdGVtKGl0ZW0pIHtcbiAgICBjaGVja2VkSXRlbXMuZ2V0KHRoaXMpLnB1c2goaXRlbSk7XG4gIH1cblxuICByZW1vdmVDaGVja2VkSXRlbShpdGVtKSB7XG4gICAgY29uc3QgaXRlbXMgPSBjaGVja2VkSXRlbXMuZ2V0KHRoaXMpO1xuICAgIGl0ZW1zLnJlZHVjZVJpZ2h0KChhY2MsIGN1cnJlbnRJdGVtLCBpbmRleCwgY3VycmVudEl0ZW1zKSA9PiB7XG4gICAgICBpZiAoY3VycmVudEl0ZW0uaWQgPT09IGl0ZW0uaWQpIHtcbiAgICAgICAgY3VycmVudEl0ZW1zLnNwbGljZShpbmRleCwgMSk7XG4gICAgICB9XG4gICAgfSwgW10pO1xuICB9XG5cbiAgY3JlYXRlQ29weSgpIHtcbiAgICBjb25zdCBjb3B5ID0gbmV3IENoZWNrZWRIYXNoSXRlbSgpO1xuXG4gICAgcGFyZW50cy5zZXQoY29weSwgWy4uLnBhcmVudHMuZ2V0KHRoaXMpXSk7XG4gICAgY2hlY2tlZEFsbC5zZXQoY29weSwgY2hlY2tlZEFsbC5nZXQodGhpcykpO1xuICAgIGNoZWNrZWRJdGVtcy5zZXQoY29weSwgWy4uLmNoZWNrZWRJdGVtcy5nZXQodGhpcyldKTtcbiAgICBjaGVja2VkSXRlbXNCYWNrVXAuc2V0KGNvcHksIFsuLi5jaGVja2VkSXRlbXNCYWNrVXAuZ2V0KHRoaXMpXSk7XG5cbiAgICByZXR1cm4gY29weTtcbiAgfVxuXG4gIG1ha2VCYWNrVXAoKSB7XG4gICAgY2hlY2tlZEl0ZW1zQmFja1VwLnNldCh0aGlzLCBbLi4uY2hlY2tlZEl0ZW1zLmdldCh0aGlzKV0pO1xuICB9XG5cbiAgcmVzdG9yZUZyb21CYWNrVXAoKSB7XG4gICAgY2hlY2tlZEl0ZW1zLnNldCh0aGlzLCBbLi4uY2hlY2tlZEl0ZW1zQmFja1VwLmdldCh0aGlzKV0pO1xuICB9XG59XG4iXX0=